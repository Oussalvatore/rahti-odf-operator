From 5d8bf8dc3ed89c2a4b1e3eb63dd98cd7f23b9ff2 Mon Sep 17 00:00:00 2001
From: Oussama Bekkouche <oussabe@csc.fi>
Date: Wed, 3 Apr 2024 11:57:11 +0000
Subject: [PATCH] Build and push workflow

---


diff --git a/.github/workflows/build-and-push.yaml b/.github/workflows/build-and-push.yaml
new file mode 100644
index 00000000..681f7785
--- /dev/null
+++ b/.github/workflows/build-and-push.yaml
@@ -0,0 +1,42 @@
+name: image-builder-publisher
+
+on: push
+
+jobs:
+  docker-push:
+    runs-on: ubuntu-latest
+    steps:
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 0
+
+    - uses: actions/setup-go@v5
+      with:
+        go-version-file: go.mod
+
+    - uses: docker/login-action@v2
+      with:
+        registry: docker.io
+        username: ${{ secrets.DOCKER_USER_NAME }}
+        password: ${{ secrets.DOCKER_TOKEN }}
+
+    - name: Build and push docker images
+      env:
+        IMAGE_REGISTRY: docker.io
+        REGISTRY_NAMESPACE: oussabe
+        IMAGE_TAG: latest
+      run: |
+        make docker-build docker-push
+        make bundle-build bundle-push
+        make catalog-build catalog-push
\ No newline at end of file
